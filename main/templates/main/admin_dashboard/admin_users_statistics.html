{% extends 'main/admin_dashboard/admin_base.html' %}
{% load static %}
{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π{% endblock %}
{% block body %}
<div class="menu-management">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary fw-bold dinner">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
    </div>
    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ -->
    <div class="card shadow-sm mb-5">
        <div class="card-header bg-white border-bottom">
            <h5 class="mb-0" style="padding-bottom: 30px">‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</h5>
        </div>
        <div class="card-body">
            {% if messages %}
                <div class="messages mb-3">
                    {% for message in messages %}
                        <div class="alert {{ message.tags }}">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
            <form method="post">
                {% csrf_token %}
                <div class="row g-3">
                    <table class="tb">
                        <tbody>
                            <tr>
                                <div class="col-md-6">
                                    <td><label for="{{ staff_form.username.id_for_label }}" class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label></td>
                                    <td>{{ staff_form.username }}
                                    {% if staff_form.username.errors %}
                                        <div class="field-error">{{ staff_form.username.errors }}</div>
                                    {% endif %}</td>
                                </div>
                            </tr>
                            <tr>
                                <div class="col-md-6">
                                    <td><label for="{{ staff_form.role.id_for_label }}" class="form-label">–†–æ–ª—å</label></td>
                                    <td>{{ staff_form.role }}
                                    {% if staff_form.role.errors %}
                                        <div class="field-error">{{ staff_form.role.errors }}</div>
                                    {% endif %}</td>
                                </div>
                            </tr>
                            <tr>
                                <div class="col-md-6">
                                    <td><label for="{{ staff_form.password1.id_for_label }}" class="form-label">–ü–∞—Ä–æ–ª—å</label></td>
                                    <td>{{ staff_form.password1 }}
                                    {% if staff_form.password1.errors %}
                                        <div class="field-error">{{ staff_form.password1.errors }}</div>
                                    {% endif %}</td>
                                </div>
                            </tr>
                            <tr>
                                <div class="col-md-6">
                                    <td><label for="{{ staff_form.password2.id_for_label }}" class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label></td>
                                    <td>{{ staff_form.password2 }}
                                    {% if staff_form.password2.errors %}
                                        <div class="field-error">{{ staff_form.password2.errors }}</div>
                                    {% endif %}</td>
                                </div>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="mt-3" style="padding-left: 20px">
                    <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</button>
                </div>
            </form>
        </div>
    </div>
    <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="status-counters mb-3 card border-left-primary h-100 shadow-sm">
                <div class="card-body text-center">
                    <h5 class="card-title text-muted">–°—Ç—É–¥–µ–Ω—Ç—ã</h5>
                    <h2 class="display-5 fw-bold text-primary">{{ role_counts.student }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="status-counters mb-3 card border-left-success h-100 shadow-sm">
                <div class="card-body text-center">
                    <h5 class="card-title text-muted">–ü–æ–≤–∞—Ä–∞</h5>
                    <h2 class="display-5 fw-bold text-success">{{ role_counts.chef }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="status-counters mb-3 card border-left-danger h-100 shadow-sm">
                <div class="card-body text-center">
                    <h5 class="card-title text-muted">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</h5>
                    <h2 class="display-5 fw-bold text-danger">{{ role_counts.admin }}</h2>
                </div>
            </div>
        </div>
    </div>
    <!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
    <div class="card shadow-sm">
        <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
            <h5 class="mb-0" style="padding-bottom: 20px">–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h5>
            <div class="d-flex gap-2" style="display: grid">
                <input type="text" id="userSearch" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏..." style="max-width: 250px;margin-bottom: 20px;">
                <button id="deleteSelectedBtn" class="btn btn-danger" disabled>
                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
                </button>
            </div>
        </div>
        <div class="card-body p-0">
            {% if users_with_roles %}
                <div class="table-responsive">
                    <table class="tb">
                        <thead>
                            <tr>
                                <th scope="col" class="tbh">
                                    <input type="checkbox" id="selectAll">
                                </th>
                                <th scope="col" class="tbh">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                                <th scope="col" class="tbh"> –†–æ–ª—å</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            {% for user in users_with_roles %}
                            <tr class="user-row" data-username="{{ user.username|lower }}">
                                <td>
                                    <input type="checkbox" class="user-checkbox" value="{{ user.username }}">
                                </td>
                                <td>{{ user.username }}</td>
                                <td>
                                    <span class="badge
                                        {% if user.role == 'student' %}bg-primary
                                        {% elif user.role == 'chef' %}bg-success
                                        {% elif user.role == 'admin' %}bg-danger
                                        {% else %}bg-secondary{% endif %}">
                                    {{ user.role|title }}
                                    </span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="text-center py-4 text-muted">
                    <p>–ù–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}