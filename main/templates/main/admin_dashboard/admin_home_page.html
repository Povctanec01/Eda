{% extends 'main/admin_dashboard/admin_base.html' %}
{% load static %}
{% block title %}Панель администратора{% endblock %}
{% block body %}
<div class="stat">
    <header class="top-bar">
        <div class="top-bar-left">
            <h1>Доброй день, {{ user.username }}!</h1>
            <p>Сегодня: <span id="currentDate">Загрузка...</span></p>
        </div>
        <div class="top-bar-right">
            <div class="notification-bell">
                <i class="fas fa-bell"></i>
                <span class="badge">8</span>
            </div>
            <div class="system-status">
                <span class="status-indicator active"></span>
                <span>Система активна</span>
            </div>
        </div>
    </header>
    <section class="dashboard-cards">
        <div class="card">
            <div class="card-icon bg-purple">
                <i class="fas fa-users"></i>
            </div>
            <div class="card-content">
                <h3>Количество студентов</h3>
                <h2 class="display-5 fw-bold text-primary">{{ student_count }}</h2>
            </div>
        </div>
        <div class="card">
            <div class="card-icon bg-blue-buys">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="card-content">
                <h3>Запросы на закупку</h3>
                <p class="card-value">{{ pending_count }}</p>
            </div>
        </div>
        <div class="card">
            <div class="card-icon bg-green">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <div class="card-content">
                <h3>Выручка сегодня</h3>
                <p class="card-value">12,540 ₽</p>
                <p class="card-desc">+8% к прошлому дню</p>
            </div>
        </div>
        <div class="card">
            <div class="card-icon bg-orange">
                <i class="fas fa-utensil-spoon"></i>
            </div>
            <div class="card-content">
                <h3>Заказов сегодня</h3>
                <p class="card-value">{{ total_ordered_today }}</p>
                <p class="card-desc"> Завтраков: {{ breakfast_today }} </p>
                <p class="card-desc"> Обедов: {{ lunch_today }}</p>
            </div>
        </div>
    </section>
    <section class="reports-section">
        <div class="section-header">
            <h2><i class="fas fa-file-invoice-dollar"></i> Отчеты и аналитика</h2>
            <div class="report-actions">
                <button class="btn btn-secondary" onclick="generateReport('daily')">
                <i class="fas fa-file-excel"></i> Дневной отчет
                </button>
                <button class="btn btn-secondary" onclick="generateReport('weekly')">
                <i class="fas fa-file-pdf"></i> Недельный отчет
                </button>
                <button class="btn btn-primary" onclick="generateReport('monthly')">
                <i class="fas fa-chart-bar"></i> Месячный отчет
                </button>
            </div>
        </div>
        <div class="reports-table">
            <table>
                <thead>
                    <tr>
                        <th>Дата</th>
                        <th>Пользователей</th>
                        <th>Заказов</th>
                        <th>Выручка</th>
                        <th>Средний чек</th>
                        <th>Популярное блюдо</th>
                        <th>Действия</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>27.01.2024</td>
                        <td>156</td>
                        <td>156</td>
                        <td>12,540 ₽</td>
                        <td>80 ₽</td>
                        <td>Омлет с овощами</td>
                        <td>
                            <button class="btn-action btn-view" onclick="viewDayDetails('27.01.2024')">
                            <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>26.01.2024</td>
                        <td>148</td>
                        <td>155</td>
                        <td>11,800 ₽</td>
                        <td>76 ₽</td>
                        <td>Суп куриный</td>
                        <td>
                            <button class="btn-action btn-view" onclick="viewDayDetails('26.01.2024')">
                            <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>25.01.2024</td>
                        <td>142</td>
                        <td>150</td>
                        <td>11,200 ₽</td>
                        <td>75 ₽</td>
                        <td>Плов</td>
                        <td>
                            <button class="btn-action btn-view" onclick="viewDayDetails('25.01.2024')">
                            <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td>24.01.2024</td>
                        <td>138</td>
                        <td>145</td>
                        <td>10,800 ₽</td>
                        <td>74 ₽</td>
                        <td>Каша овсяная</td>
                        <td>
                            <button class="btn-action btn-view" onclick="viewDayDetails('24.01.2024')">
                            <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="reports-summary">
            <div class="summary-card">
                <h4>Итого за неделю</h4>
                <p class="summary-value">845 заказов</p>
                <p class="summary-value">46,340 ₽</p>
            </div>
            <div class="summary-card">
                <h4>Средние показатели</h4>
                <p class="summary-value">169 заказов/день</p>
                <p class="summary-value">78 ₽ средний чек</p>
            </div>
            <div class="summary-card">
                <h4>Прогноз на месяц</h4>
                <p class="summary-value">~3,400 заказов</p>
                <p class="summary-value">~265,200 ₽</p>
            </div>
        </div>
    </section>
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Детали за день</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modalContent"></div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">Закрыть</button>
                <button class="btn btn-primary" onclick="printDetails()"><i class="fas fa-print"></i> Печать</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}