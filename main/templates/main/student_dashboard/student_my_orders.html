{% extends 'main/student_dashboard/student_base.html' %}
{% load static %}
{% block title %}Мои заказы{% endblock %}
{% block body %}
<div class="menu-management">
    <h2 class="dinner2"><i class="fas fa-history"></i> Мои заказы</h2>
    {% if orders %}
    <div class="orders-list">
        {% for order in orders %}
        <div class="order-item card" style="margin-top: 15px; flex-direction: row;">
            <div class="order-info" style="margin-top: 15px">
                <h4>{{ order.card.title|default:"[Удалено]" }}</h4>
                <p class="text-muted">{{ order.ordered_at|date:"d.m.Y H:i" }}</p>
            </div>
            <div class="order-status">
                {% if order.status == 'pending' %}
                <span class="badge bg-warning">Готовится</span>
                {% elif order.status == 'ready' %}
                <span class="badge bg-success">Готов! Заберите в столовой</span>
                {% elif order.status == 'received' %}
                <span class="badge bg-secondary">Получен</span>
                {% endif %}
            </div>
            {% if order.status == 'ready' %}
            <form method="post" style="margin-top: 8px;" action="{% url 'student_mark_received' order.id %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-outline-success">
                <i class="fas fa-check-circle"></i> Я забрал
                </button>
            </form>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-muted">У вас пока нет заказов.</p>
    {% endif %}
</div>
{% endblock %}